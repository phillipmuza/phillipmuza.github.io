define(["require", "exports", "jquery", "jquery", "lib/jquery/cookie"], function (require, exports, $) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.setVirtualAACookieForUrl = void 0;
    function cleanUrlAndSetCookie(element) {
        var isAnchorElement = (element.tagName === 'A');
        var dataVirtualValue = element.getAttribute("data-virtual");
        var dataSRVirtualValue = element.getAttribute("data-virtual-sr");
        var hrefValue = element.getAttribute("href");
        if (isAnchorElement && (dataSRVirtualValue || dataVirtualValue) && hrefValue) {
            var url = hrefValue.replace(/^.*\/\/[^\/]+/, '');
            if (dataVirtualValue) {
                (0, exports.setVirtualAACookieForUrl)(dataVirtualValue, url);
            }
            if (dataSRVirtualValue) {
                $.cookie('virtualRootSR', dataSRVirtualValue, { path: url, expires: 730 });
            }
            return url;
        }
        return null;
    }
    var setVirtualAACookieForUrl = function (dataVirtualValue, href) {
        var url = href.replace(/^.*\/\/[^\/]+/, '');
        var domain = "study.com";
        var hostParts = window.location.host.split(".");
        var numHostParts = hostParts.length;
        if (numHostParts > 1) {
            domain = hostParts[numHostParts - 2] + '.' + hostParts[numHostParts - 1];
        }
        $.cookie('virtualAA', dataVirtualValue, { domain: domain, path: url, expires: 730 });
    };
    exports.setVirtualAACookieForUrl = setVirtualAACookieForUrl;
    $(document.body).on("click", "a", function (e) {
        var element = e.currentTarget;
        var url = cleanUrlAndSetCookie(element);
        if (url !== null && !e.ctrlKey && !e.metaKey && !e.isDefaultPrevented()) {
            e.preventDefault();
            var targetAttr = element.getAttribute("target");
            if (targetAttr === "_blank") {
                window.open(url, targetAttr);
            }
            else {
                window.location.href = url;
            }
        }
    });
    $(document.body).on("contextmenu", "a", function (e) {
        cleanUrlAndSetCookie(e.currentTarget);
    });
    $(document.body).on("mousedown", "a", function (e) {
        cleanUrlAndSetCookie(e.currentTarget);
    });
});

//# sourceMappingURL=virtualOnClick.js.map
